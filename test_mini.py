from minipy import KMer, minimize

TEST_SEQ =  "AACCTTGGACTACGATCGGGGGAACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC" \
            "AACCTTGGACTACGATCGGGGGAACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC"

KMER_LEN = 29
WIN_LEN = 9

MINMIZERS = [
    KMer(646286436247489772, 4,  False),
    KMer(4800021203147078872, 7,  False),
    KMer(3489739751552373074, 15, False),
    KMer(181256282556872170, 21,  False),
    KMer(301194077553889042, 28,  False),
    KMer(1984613911990073889, 29, False),
    KMer(3969227673656292348, 30, False),
    KMer(5164955381998653605, 39, False),
    KMer(3604134460204853669, 41, False),
    KMer(3579537055126917398, 46, False),
    KMer(2297258160501326761, 49, True),
    KMer(3003143238680945871, 57, False),
    KMer(1972518964064674621, 63, True),
    KMer(1348383673427691446, 68, False),
    KMer(646286436247489772, 74, False),
    KMer(4800021203147078872, 77, False),
    KMer(3489739751552373074, 85, False),
    KMer(181256282556872170, 91, False),
    KMer(301194077553889042, 98, False),
    KMer(1984613911990073889, 99, False),
    KMer(3969227673656292348, 100, False),
    KMer(5164955381998653605, 109, False),
    KMer(3604134460204853669, 111, False)
]

def test_minmize():
  minimizers = minimize(TEST_SEQ, KMER_LEN, WIN_LEN)
  
  assert len(minimizers) == len(MINMIZERS)
  for v, e in zip(minimizers, MINMIZERS):
    assert v.value() == e.value()
    assert v.position() == e.position()
    assert v.strand() == e.strand()

test_minmize()