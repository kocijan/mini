from minipy import KMer, minimize

TEST_SEQ =  "AACCTTGGACTACGATCGGGGGRACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC" \
            "AACCTTGGACTACGATCGGGGGRACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC"

KMER_LEN = 29
WIN_LEN = 9

MINMIZERS = [
    KMer(36269681106532217, 6, 1),  KMer(24880002093386105, 9, 0),
    KMer(12372493052543089, 16, 0), KMer(4015999444112461, 25, 0),
    KMer(34380640922163105, 33, 1), KMer(68665488426213272, 39, 1),
    KMer(64870379786710710, 43, 0), KMer(20644342140563489, 44, 0),
    KMer(28346801699364282, 51, 0), KMer(39736456831455692, 56, 0),
    KMer(29648685663207134, 61, 1), KMer(36027946598956616, 63, 1),
    KMer(66205828659723398, 67, 1), KMer(36269681106532217, 76, 1),
    KMer(24880002093386105, 79, 0), KMer(12372493052543089, 86, 0),
    KMer(4015999444112461, 95, 0),  KMer(34380640922163105, 103, 1)
]

def test_minmize():
  minimizers = minimize(TEST_SEQ, KMER_LEN, WIN_LEN)
  
  assert len(minimizers) == len(MINMIZERS)
  for v, e in zip(minimizers, MINMIZERS):
    assert v.value() == e.value()
    assert v.position() == e.position()
    assert v.strand() == e.strand()
