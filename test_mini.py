from minipy import KMer, minimize

TEST_SEQ = "AACCTTGGACTACGATCGGGGGRACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC" \
    "AACCTTGGACTACGATCGGGGGRACCCCGAACATCTCCTCTCCCATTCTCCCTCCCCTAGAGATTCATTC"

KMER_LEN = 29
WIN_LEN = 9

MINMIZERS = [
    KMer(6729498870055254, 0, 0),
    KMer(26917995480221016, 1, 0),
    KMer(31962435822159069, 8, 0),
    KMer(27983259556198237, 11, 0),
    KMer(16475779019485013, 18, 1),
    KMer(6016861954461557, 22, 0),
    KMer(5477618012740951, 29, 0),
    KMer(15607192426358922, 36, 1),
    KMer(15823564291212200, 40, 1),
    KMer(12350680396898978, 47, 1),
    KMer(50959031995953832, 52, 1),
    KMer(38549926042956173, 58, 0),
    KMer(40338064383875290, 60, 0),
    KMer(68706181422361217, 66, 0),
    KMer(6729498870055254, 70, 0),
    KMer(26917995480221016, 71, 0),
    KMer(31962435822159069, 78, 0),
    KMer(27983259556198237, 81, 0),
    KMer(16475779019485013, 88, 1),
    KMer(6016861954461557, 92, 0),
    KMer(5477618012740951, 99, 0),
    KMer(15607192426358922, 106, 1),
]


def test_minmize():
  minimizers = minimize(TEST_SEQ, KMER_LEN, WIN_LEN)

  assert len(minimizers) == len(MINMIZERS)
  for v, e in zip(minimizers, MINMIZERS):
    assert v.value() == e.value()
    assert v.position() == e.position()
    assert v.strand() == e.strand()
